<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Scorebot</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
  </head>
  <body>
      <fieldset>
          <h1 align="center"> Scorebot </h1>
          <div class="container">
              <form action="/" method="get">
                  <input type="submit" class="ghost-button" value="Back to Home">
              </form>
              <br>
              <form action="/matches" method="post">
                    <input type="submit" class="ghost-button" value="Back to Matches">
              </form>
              <% if(match !== null){ %>
                <br>
                <a class="ghost-button" href="matches/scorebot?id=<%= match.id %>" value="Refresh"></a>
              <% } %>
          </div>
      
        <% if(match !== null){ %>
          <h3 align="center"> <%=match.team1.name%> vs <%=match.team2.name%> </h3>
          <h4 align="center"> <%= match.event.name %> </h4> 
          <h4 align="center"> Maps:
          <% for(var i=0; i < match.maps.length; i++) { %>
            <% if(match.maps[i].statsId){ %>
              <a href="../results/detailedstats?id=<%=match.maps[i].statsId%>"><span> <%=match.maps[i].name%></span></a>
            <% } else { %>
              <span> <%=match.maps[i].name%></span>
            <% } %>
            <% for(var k=0; k < match.maps[i].result.length; k++) { %>
              <% if(match.maps[i].result[k] == ' '){ %>
                <span> (<%= match.maps[i].result.substring(0, k).trim()%>) </span>
                <% break; %>
              <% } %>
            <% } %>
          <% } %>
          </h4>
          <% if(match.additionalInfo.trim() != ""){ %>
            <h5 align="center"> <%=match.additionalInfo%> </h5>
          <% } %>
        <% } else { %>
          <p align="center"> No match found </p>
        <% } %>
        <% if(update !== null){ %>
          <h3 align="center"> Scoreboard </h3> 
          <h4 align="center"> <%= update.Title %> </h4> 
          <h4 align="center"> <%= update.CTName %> Player Stats </h4>
            <table>
                    <tr>
                        <th>Player</th>
                        <th>Kills</th> 
                        <th>Deaths</th>
                        <th>ADR</th>
                    </tr>
                    <% for(var i = 0; i < update.CTs.length; i++) { %>
                        <tr>
                            <td align="center"><%= update.CTs[i].name %></td>
                            <td align="center"><%= update.CTs[i].score %></td>
                            <td align="center"><%= update.CTs[i].deaths %></td>
                            <td align="center"><%= update.CTs[i].damagePrRound.toFixed(2) %></td>
                        </tr>
                    <% } %>
            </table>
            <br>
            <h4 align="center"> <%= update.TName %> Player Stats </h4>
            <table>
                    <tr>
                        <th>Player</th>
                        <th>Kills</th> 
                        <th>Deaths</th>
                        <th>ADR</th>
                    </tr>
                    <% for(var i = 0; i < update.Ts.length; i++) { %>
                        <tr>
                            <td align="center"><%= update.Ts[i].name %></td>
                            <td align="center"><%= update.Ts[i].score %></td>
                            <td align="center"><%= update.Ts[i].deaths %></td>
                            <td align="center"><%= update.Ts[i].damagePrRound.toFixed(2) %></td>
                        </tr>
                    <% } %>
            </table>
        <% } else {%>
          <p align="center"> No updates yet </p>
        <% } %>
        <% if(log !== null){ %>
          <h4 align="center"> Log </h4>    
          <% for(var i = log.length - 1; i >= 0; i--) { %>
              <h5 align="center"><%= log[i] %></h5>
          <% } %>
        <% } else {%>
          <p align="center" id="log1"> No log yet </p>
        <% } %>
        <% if(error !== null){ %>
          <p align="center"><%= error %></p>
        <% } %>
      </fieldset>
  </body>
</html>